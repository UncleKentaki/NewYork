<!DOCTYPE html>
<html>
<head>	
	<meta charset="UTF-8">
	<title>
		The Best New York Times Search
	</title>

	<script src="https://code.jquery.com/jquery-3.1.1.js"></script>
	<script src="assets/javascript/app.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">

</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h1 id="title">NEW YORK TIMES SEARCH</h1>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12" id="searchParamaters">
				<h2>SEARCH PARAMETERS</h2>
				<div class="form-group">
  					<label for="exampleSearchTerm" class="col-2 col-form-label">Search Term:</label>
  					<div class="col-10">
    				<input class="form-control" type="search" value="" id="search">
 				 </div>
 				 <div class="form-group">
  					<label for="exampleRecords" class="col-2 col-form-label">Number of Records to Retrieve: </label>
  					<div class="col-10">
    				<select class="form-control" type="number" value="" id="numRecords">
    					<option>10</option>
    					<option>20</option>
    					<option>30</option>
    				</select>
 				 </div>
 				 <div class="form-group">
  					<label for="exampleStartYear" class="col-2 col-form-label">Start year (optional):</label>
  					<div class="col-10">
    				<input class="form-control" type="text" value="" id="startYear">
 				 </div>
 				 <div class="form-group">
  					<label for="exampleEndYear" class="col-2 col-form-label">End Year (optional):</label>
  					<div class="col-10">
    				<input class="form-control" type="text" value="" id="endYear">
 				 </div>
				<button id="searchButton">Search</button>
				<button id="clearResults">Clear</button>
			</div>
		</div>
		<div class="row">
			<div class= "col-md-12" id="topArticles">
				<h2 id="topArticlesTitle">TOP ARTICLES</h2>
			</div>
		</div>
	</div>
	
	<script type="text/javascript">


    // When user presses search get data
    $("#searchButton").on("click", function(){
        // Get user input
        var searchKey = $("#search").text();
        var numRecords = $("#numRecords").text();
        var startYear = $("#startYear").text();
        var endYear = $("#endYear").text();

        var authKey = "b9f91d369ff59547cd47b931d8cbc56b:0:74623931";
        var queryURL = "https://api.nytimes.com/svc/search/v2/articlesearch.json?api-key=" + authKey + "&q=" + searchKey + "";
        queryURL = encodeURI(queryURL);

        $.ajax({
            url: queryURL,
            method: "GET"
        }).done(function(response) {
            console.log(response);
            results = response.response.docs;
            console.log(results);

            for(var i = 0; i<results.length; i++){
                var newDiv = $("<div>");
                var title = $("<h2>").text(results[i].headline.main);
                var author = $("<p>").text(results[i].byline);
                var weburl = $("<p>").text(results[i].web_url);
                newDiv.append(title);
                newDiv.append(author);
                newDiv.append(weburl);

                $("#topArticles").append(newDiv);
            }


        });
    });

</script>
</body>
</html>